import{A as I,P as B,J as E,p as i,q as e,K as H,Q as $,v as A}from"./index-4a63d28d.js";import{I as M}from"./index.es-ed8105b7.js";import{P as q}from"./list-5b6e7da9.js";const J="_root_hzk97_1",K="_layout_hzk97_76",Q="_main_hzk97_81",R="_container_hzk97_87",D="_playList_hzk97_111",F="_card_hzk97_115",G="_filter_hzk97_124",O="_filterItem_hzk97_127",U="_filterTitle_hzk97_133",V="_filterBox_hzk97_143",W="_listHead_hzk97_165",X="_filterClose_hzk97_174",Y="_type_hzk97_180",a={root:J,layout:K,main:Q,container:R,"light-scheme":"_light-scheme_hzk97_92","dark-scheme":"_dark-scheme_hzk97_96",playList:D,card:F,filter:G,filterItem:O,filterTitle:U,filterBox:V,listHead:W,filterClose:X,type:Y},r="全部歌单",n={order:"hot",cat:r,limit:48,offset:0};function et(){const{message:d}=I.useApp(),y=B(),[g,h]=E(),m=g.get("cat")??r,[l,k]=i.useState(r),[j,L]=i.useState([]),[o,f]=i.useState([]),[z,_]=i.useState(!0),[p,u]=i.useState(!0),[N,v]=i.useState(0),S=async()=>{_(!0);const{data:t}=await $(),s=[];if(t.code!==200)return d.error({content:t.message});for(let c in t.categories)s.push({name:t.categories[c],children:t.sub.filter(w=>w.category==c)});L(s),_(!1)},x=async t=>{u(!0);const{data:s}=await A(t);if(s.code!==200)return d.error({content:s.message});const c=t.offset!==0?[...o,...s.playlists]:s.playlists;f(c),u(!1),v(s.total)},P=()=>{if(!p){const t={...n,offset:o.length};x(t)}},C=t=>()=>{h({cat:t.name,order:n.order})},T=()=>{h()};return i.useEffect(()=>{S()},[]),i.useEffect(()=>{const t={...n,offset:0,cat:m};f([]),k(m),x(t)},[y]),e.jsxs("div",{className:a.playList,children:[e.jsx(H,{tip:"Loading",spinning:z,children:e.jsx("div",{className:`${a.filter} ${a.card}`,children:j.map(t=>e.jsxs("div",{className:a.filterItem,children:[e.jsx("div",{className:a.filterTitle,children:t.name}),e.jsx("div",{className:a.filterBox,children:t.children.map(s=>e.jsx("span",{className:`${l===s.name?"active":""}`,onClick:C(s),children:s.name},s.name))})]},t.name))})}),e.jsxs("div",{className:a.wrapper,children:[e.jsxs("div",{className:a.listHead,children:[e.jsxs("h2",{children:[l,l!==r&&e.jsx("em",{className:a.filterClose,children:e.jsx("i",{className:"iconfont icon-closed",onClick:T})})]}),e.jsx("div",{className:a.type,children:e.jsx("span",{className:n.order==="hot"?"active":"",children:"热门"})})]}),e.jsx(M,{dataLength:o.length,next:P,hasMore:o.length<N,children:e.jsx(q,{lists:o,loading:p})})]})]})}export{et as default};
