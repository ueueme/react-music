import{A as B,T as O,x as z,J,P as V,p as l,q as e,D as S,L as n,F as h,M as W,U as X,O as G,B as b,V as K,W as Q,X as Y}from"./index-4a63d28d.js";const Z="_root_1d1lh_1",ee="_layout_1d1lh_76",se="_main_1d1lh_81",ae="_container_1d1lh_87",ce="_detail_1d1lh_111",te="_detail_layout_1d1lh_127",oe="_detail_main_1d1lh_133",ne="_detail_aside_1d1lh_137",le="_cover_1d1lh_143",ie="_cover_img_1d1lh_147",re="_cover_desc_1d1lh_154",_e="_cover_desc_all_1d1lh_176",me="_sub_playlist_1d1lh_187",de="_author_home_1d1lh_193",he="_detail_info_1d1lh_205",ve="_cover_info_1d1lh_208",ge="_cover_header_1d1lh_211",ue="_cover_author_1d1lh_224",xe="_cover_avatar_1d1lh_228",je="_cover_name_1d1lh_235",pe="_cover_date_1d1lh_235",Ne="_cover_avatarIcon_1d1lh_241",ye="_cover_digital_1d1lh_250",fe="_cover_tags_1d1lh_265",Ie="_tag_1d1lh_275",Se="_song_main_1d1lh_286",be="_song_header_1d1lh_290",$e="_play_all_1d1lh_329",Le="_showAllSongsTips_1d1lh_340",Ae="_aside_title_1d1lh_356",ke="_aside_main_1d1lh_373",Te="_recom_main_1d1lh_377",we="_recom_img_1d1lh_380",Ce="_recom_item_1d1lh_386",De="_recom_info_1d1lh_390",Fe="_recom_name_1d1lh_394",Ue="_recom_author_1d1lh_407",Me="_comment_main_1d1lh_417",Pe="_comment_img_1d1lh_421",Ee="_comment_item_1d1lh_428",He="_comment_info_1d1lh_432",Re="_comment_userInfo_1d1lh_436",qe="_comment_name_1d1lh_440",Be="_comment_desc_1d1lh_445",Oe="_comment_date_1d1lh_455",s={root:Z,layout:ee,main:se,container:ae,"light-scheme":"_light-scheme_1d1lh_92","dark-scheme":"_dark-scheme_1d1lh_96",detail:ce,detail_layout:te,detail_main:oe,detail_aside:ne,cover:le,cover_img:ie,cover_desc:re,cover_desc_all:_e,sub_playlist:me,author_home:de,detail_info:he,cover_info:ve,cover_header:ge,cover_author:ue,cover_avatar:xe,cover_name:je,cover_date:pe,cover_avatarIcon:Ne,cover_digital:ye,cover_tags:fe,tag:Ie,song_main:Se,song_header:be,play_all:$e,showAllSongsTips:Le,aside_title:Ae,aside_main:ke,recom_main:Te,recom_img:we,recom_item:Ce,recom_info:De,recom_name:Fe,recom_author:Ue,comment_main:Me,comment_img:Pe,comment_item:Ee,comment_info:He,comment_userInfo:Re,comment_name:qe,comment_desc:Be,comment_date:Oe};function Ve(){var y;const{message:r}=B.useApp(),[_,$]=O(a=>[a.isLogin,a.setLoginModle]),L=z(a=>a.playAllSong),[A,ze]=J(),k=V(),v=A.get("id")??"",[c,T]=l.useState({}),[g,u]=l.useState([]),[x,w]=l.useState([]),[j,C]=l.useState([]),[D,m]=l.useState(!0),[F,p]=l.useState(0),N=async a=>{m(!0);const{data:t}=await G(a);if(t.code!==200)return r.error({content:t.message});if(T(t.playlist),_)U(t.playlist.trackIds);else{const d=b(t.playlist.tracks,t.privileges);u(d),p(d.length),m(!1)}},U=async a=>{const t=[];let i=[];for(let o=0;o<a.length;o+=500)t.push(a.slice(o,o+500));for(let o=0;o<t.length;o++){const f=[];t[o].map(q=>{f.push(q.id)});const{data:I}=await K({ids:f.join(","),timestamp:new Date().valueOf()+o});i=i.concat(b(I.songs,I.privileges))}u(i),p(i.length),m(!1)},M=async a=>{const{data:t}=await Q(a);if(t.code!==200)return r.error({content:t.message});w(t.playlists)},P=async a=>{const{data:t}=await Y(a);if(t.code!==200)return r.error({content:t.message});C(t.comments)},E=()=>{L(g)},H=()=>{$(!0)},R=a=>{N({id:a,s:8}),M({id:a}),P({id:a,limit:8})};return l.useEffect(()=>{R(v)},[k]),l.useEffect(()=>{N({id:v,s:8})},[_]),e.jsx("div",{className:s.detail,children:e.jsxs("div",{className:s.detail_layout,children:[e.jsxs("div",{className:s.detail_main,children:[e.jsxs("div",{className:s.cover,children:[e.jsx("div",{className:s.cover_img,children:e.jsx("img",{src:c.coverImgUrl,alt:""})}),e.jsxs("div",{className:s.cover_desc,children:[c.trackNumberUpdateTime&&e.jsxs(e.Fragment,{children:[e.jsxs("h4",{children:["更新时间",e.jsx("em",{children:c.updateFrequency})]}),e.jsx("p",{children:S(c.trackNumberUpdateTime,"yyyy-MM-dd HH:mm:ss")})]}),c.subscribers&&e.jsxs(e.Fragment,{children:[e.jsx("h4",{children:"喜欢这个歌单的人"}),e.jsx("div",{className:s.sub_playlist,children:c.subscribers.map(a=>e.jsx(n,{to:`/user?id=${a.userId}`,className:s.author_home,children:e.jsx("img",{src:a.avatarUrl})},a.userId))})]}),c.description&&e.jsxs(e.Fragment,{children:[e.jsx("h4",{children:"介绍"}),e.jsx("pre",{className:s.cover_desc_all,children:c.description})]})]})]}),e.jsxs("div",{className:s.detail_info,children:[e.jsxs("div",{className:s.cover_info,children:[e.jsx("div",{className:s.cover_header,children:c.name}),e.jsx("div",{className:s.cover_author,children:c.creator&&e.jsxs(e.Fragment,{children:[e.jsx(n,{to:`/user?id=${c.creator.userId}`,className:s.author_home,children:e.jsx("img",{src:c.creator.avatarUrl,className:s.cover_avatar})}),e.jsxs("div",{className:s.cover_name,children:[e.jsx(n,{to:`/user?id=${c.creator.userId}`,className:s.author_home,children:c.creator.nickname}),c.creator.avatarDetail&&e.jsx("img",{src:(y=c.creator.avatarDetail)==null?void 0:y.identityIconUrl,className:s.cover_avatarIcon})]}),e.jsxs("div",{className:s.cover_date,children:[S(c.createTime,"yyyy-MM-dd")," 创建"]})]})}),e.jsxs("div",{className:s.cover_digital,children:[e.jsxs("span",{className:s.cover_playCount,children:[" ",e.jsx("i",{className:"iconfont icon-playnum"})," ",h(c.playCount),"次播放"]}),e.jsxs("span",{className:s.cover_collect,children:[" ",e.jsx("i",{className:"iconfont icon-collect"})," ",h(c.subscribedCount),"次收藏"]}),e.jsxs("span",{className:s.cover_comment,children:[" ",e.jsx("i",{className:"iconfont icon-comment"})," ",h(c.commentCount),"条留言"]})]}),e.jsx("div",{className:s.cover_tags,children:c.tags&&c.tags.length>0&&e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"Tags:"}),c.tags.map(a=>e.jsxs(n,{className:s.tag,to:`/playlist?cat=${a}`,children:["#",a]},a))]})})]}),e.jsxs("div",{className:s.song_main,children:[e.jsxs("div",{className:s.song_header,children:[e.jsxs("h4",{children:["歌曲列表 ",e.jsxs("em",{children:["共 ",F+" 首歌"]})]}),e.jsxs("span",{className:s.play_all,onClick:E,children:[e.jsx("i",{className:"iconfont icon-audio-play"})," 播放全部"]}),e.jsxs("span",{className:`collect ${c.subscribed?"active":""} `,children:[e.jsx("i",{className:`iconfont icon-collect${c.subscribed?"-active":""}`})," ",c.subscribed?"已收藏":"收藏"]})]}),e.jsx(W,{lists:g,loading:D}),!_&&e.jsx("div",{className:s.showAllSongsTips,children:e.jsx("span",{onClick:H,children:"登录后查看全部歌曲"})})]})]})]}),e.jsxs("div",{className:s.detail_aside,children:[x.length>0&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:s.aside_title,children:"相关歌单推荐"}),e.jsx("div",{className:`${s.aside_main} ${s.recom_main}`,children:x.map(a=>e.jsxs("div",{className:s.recom_item,children:[e.jsx(n,{to:`/playlist/detail?id=${a.id}`,children:e.jsx("img",{className:s.recom_img,src:a.coverImgUrl})}),e.jsxs("div",{className:s.recom_info,children:[e.jsx(n,{to:`/playlist/detail?id=${a.id}`,className:s.recom_name,children:a.name}),e.jsxs("div",{className:s.recom_author,children:["By. ",e.jsx(n,{to:`/user?id=${a.creator.userId}`,children:a.creator.nickname})]})]})]},a.id))})]}),j.length>0&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:s.aside_title,children:"歌单评论"}),e.jsx("div",{className:`${s.aside_main} ${s.comment_main}`,children:j.map(a=>e.jsxs("div",{className:s.comment_item,children:[e.jsx(n,{to:`/user?id=${a.commentId}`,children:e.jsx("img",{className:s.comment_img,src:a.user.avatarUrl})}),e.jsxs("div",{className:s.comment_info,children:[e.jsxs("div",{className:s.comment_userInfo,children:[e.jsx(n,{to:`/user?id=${a.commentId}`,className:s.comment_name,children:a.user.nickname}),e.jsx("span",{className:s.comment_date,children:X(a.time)})]}),e.jsx("div",{className:s.comment_desc,children:a.content})]})]},a.commentId))})]})]})]})})}export{Ve as default};
