import{p as n,q as e,K as E,L as x,F as T,S as f,A as z,Y as R,Z as P}from"./index-4a63d28d.js";import{I as H}from"./index.es-ed8105b7.js";import{b as N,c as w}from"./area-109c5739.js";const M="_root_1sc6o_1",O="_layout_1sc6o_76",F="_main_1sc6o_81",U="_container_1sc6o_87",Y="_singer_main_1sc6o_111",q="_singer_item_load_1sc6o_127",B="_singer_item_1sc6o_127",D="_item_bg_1sc6o_143",G="_item_img_1sc6o_162",K="_item_follow_1sc6o_172",Z="_item_author_1sc6o_196",J="_item_info_1sc6o_204",Q="_item_name_1sc6o_216",V="_name_1sc6o_221",W="_item_count_1sc6o_241",X="_item_count_type_1sc6o_245",ee="_item_count_album_1sc6o_264",i={root:M,layout:O,main:F,container:U,"light-scheme":"_light-scheme_1sc6o_92","dark-scheme":"_dark-scheme_1sc6o_96",singer_main:Y,singer_item_load:q,singer_item:B,item_bg:D,item_img:G,item_follow:K,item_author:Z,item_info:J,item_name:Q,name:V,item_count:W,item_count_type:X,item_count_album:ee},se=n.memo(function({list:t,ctx:a}){const{followHandler:l,isOperEnd:c}=n.useContext(a),[r,d]=n.useState(!1),h=()=>{l(t)};return n.useEffect(()=>{t.id==c.id&&d(!c.state)},[c]),e.jsx(E,{tip:"Loading",spinning:r,className:i.singer_item,children:e.jsxs("div",{className:i.singer_item,children:[e.jsx("div",{className:i.item_bg,children:e.jsx("img",{src:`${t.img1v1Url}?param=120y120`,alt:""})}),e.jsx(x,{to:`/singer/detail?id=${t.id}`,className:i.item_img,children:e.jsx("img",{src:`${t.img1v1Url}?param=200y200`,alt:"",className:i.item_author})}),e.jsxs("div",{className:i.item_follow,onClick:h,children:[e.jsx("i",{className:`iconfont icon-collect${t.followed?"-active":""}`}),e.jsx("span",{children:t.followed?"已关注":"关注TA"})]}),e.jsxs("div",{className:i.item_info,children:[e.jsxs("div",{className:i.item_name,children:[e.jsx(x,{className:i.name,to:`/singer/detail?id=${t.id}`,children:t.name}),t.accountId&&e.jsx(x,{to:`/user?id=${t.accountId}`,children:e.jsx("i",{className:"iconfont icon-singer"})})]}),e.jsxs("div",{className:i.item_count,children:[e.jsxs("div",{className:i.item_count_type,children:[e.jsx("span",{children:"单曲"}),e.jsx("em",{children:t.musicSize})]}),e.jsxs("div",{className:`${i.item_count_type} ${i.item_count_album}`,children:[e.jsx("span",{children:"专辑"}),e.jsx("em",{children:t.albumSize})]}),e.jsxs("div",{className:i.item_count_type,children:[e.jsx("span",{children:"粉丝"}),e.jsx("em",{children:T(t.fansCount)})]})]})]})]})})}),te=n.memo(function({ctx:t,count:a=6}){const{lists:l,loading:c}=n.useContext(t);return e.jsxs("div",{className:i.singer_main,children:[!c||l.length>a?l.map((r,d)=>e.jsx(se,{list:r,ctx:t},`${r.id}item${d}`)):"",c&&[...new Array(a)].map((r,d)=>e.jsxs("div",{className:`${i.singer_item} ${i.singer_item_load}`,children:[e.jsx(f.Image,{active:!0,block:!0,className:"skeleton-img"}),e.jsxs("div",{className:i.item_info,children:[e.jsx(f.Button,{active:!0,size:"small",block:!0,className:"info_title"}),e.jsxs("div",{className:i.item_count,children:[e.jsx(f.Avatar,{active:!0,size:"small"}),e.jsx(f.Avatar,{active:!0,size:"small"}),e.jsx(f.Avatar,{active:!0,size:"small"})]})]})]},d))]})}),ie="_root_kswu0_1",ne="_layout_kswu0_76",ae="_main_kswu0_81",ce="_container_kswu0_87",oe="_singer_kswu0_111",le="_singer_filter_kswu0_115",re="_filter_header_kswu0_123",me="_filter_main_kswu0_141",_e="_filter_item_kswu0_147",_={root:ie,layout:ne,main:ae,container:ce,"light-scheme":"_light-scheme_kswu0_92","dark-scheme":"_dark-scheme_kswu0_96",singer:oe,singer_filter:le,filter_header:re,filter_main:me,filter_item:_e},b=n.createContext();let k=[];const y=()=>{const u=[];for(let t=0;t<26;t++)u.push({label:String.fromCharCode(65+t),val:String.fromCharCode(97+t)});k=[{label:"热门",val:-1},...u,{label:"#",val:0}]};y();const he=n.memo(function(){const{message:t}=z.useApp(),[a,l]=n.useState([]),[c,r]=n.useState(!0),[d,h]=n.useState(!1),[S,j]=n.useState({id:"",state:!0}),[m,v]=n.useState({area:N[0].val,type:w[0].val,initial:-1,limit:30,offset:0,timestamp:new Date().getTime()}),$=async()=>{r(!0);const{data:s}=await P(m);if(s.code!==200)return t.error({content:s.message});const o=m.offset!==0?[...a,...s.artists]:s.artists;l(o),r(!1),h(s.more)},A=n.useCallback(async s=>{j({id:s.id,state:!1});const{data:o}=await R({id:s.id,t:+!s.followed});if(o.code!==200)return t.error({content:o.message});t.success({content:"操作成功~"});const p=[...a],I=p.find(L=>L.id==s.id);I.followed=+!s.followed,l(p),j({id:s.id,state:!0})},[a]),C=()=>{if(!c){const s={...m,offset:a.length};v(s)}},g=(s,o)=>()=>{l([]),v({...m,[s]:o,offset:0})};return n.useEffect(()=>{y()},[]),n.useEffect(()=>{$()},[m]),e.jsx(e.Fragment,{children:e.jsxs("div",{className:_.singer,children:[e.jsxs("div",{className:_.singer_filter,children:[e.jsxs("div",{className:_.filter_header,children:[e.jsx("i",{className:"iconfont icon-filter"}),e.jsx("span",{children:"筛选列表"})]}),e.jsxs("div",{className:_.filter_main,children:[e.jsx("div",{className:_.filter_item,children:k.map((s,o)=>e.jsx("em",{className:s.val===m.initial?"active":"",onClick:g("initial",s.val),children:s.label},s.label))}),e.jsx("div",{className:_.filter_item,children:N.map((s,o)=>e.jsx("em",{className:s.val===m.area?"active":"",onClick:g("area",s.val),children:s.label},s.label))}),e.jsx("div",{className:_.filter_item,children:w.map((s,o)=>e.jsx("em",{className:s.val===m.type?"active":"",onClick:g("type",s.val),children:s.label},s.label))})]})]}),e.jsx(b.Provider,{value:{lists:a,loading:c,followHandler:A,isOperEnd:S},children:e.jsx("div",{className:_.singer_main,children:e.jsx(H,{dataLength:a.length,next:C,hasMore:d,children:e.jsx(te,{ctx:b})})})})]})})});export{he as default};
